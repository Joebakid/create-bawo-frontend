// src/fonts/css-generator.js
const fs = require("fs");
const path = require("path");

function ensureFontsCSS(projectDir) {
  const stylesDir = path.join(projectDir, "src/styles");
  const fontsFile = path.join(stylesDir, "fonts.css");

  // 1️⃣ Ensure src/styles exists
  if (!fs.existsSync(stylesDir)) {
    fs.mkdirSync(stylesDir, { recursive: true });
  }

  // 2️⃣ Ensure fonts.css exists
  if (!fs.existsSync(fontsFile)) {
    fs.writeFileSync(
      fontsFile,
      `/* ===========================
   FONT DEFINITIONS
   Generated by create-bawo-frontend
   =========================== */\n\n`
    );
  }

  return fontsFile;
}

function generateFontCSS(projectDir, fontKey, font) {
  const file = ensureFontsCSS(projectDir);

  const css = font.weights
    .map(
      (w) => `
@font-face {
  font-family: "${font.family}";
  src: url("../fonts/${fontKey}/${font.family.replace(
    / /g,
    "-"
  )}-${w}.woff2") format("woff2");
  font-weight: ${w};
  font-style: normal;
  font-display: swap;
}
`
    )
    .join("\n");

  fs.appendFileSync(file, css);
}

module.exports = { generateFontCSS };
